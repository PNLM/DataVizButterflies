---
title: "Data Visualisation Project"
author: "PNL & co"
date: "22/04/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



```{r,include=FALSE,warning=FALSE}
library(dygraphs)
library(xts) 
library(readr)
library(leaflet)
library(dplyr)
library(ggplot2)
library(hrbrthemes)

dataset <- read_delim("data_chunk.csv", 
    "\t", escape_double = FALSE, trim_ws = TRUE, 
    skip = 1)
```


Le jeu de données analysé est le résultat du UK Butterfly Monitoring Scheme, une démarche qui comme son nom l'indique vise à surveiller l'évolution des populations de papillons au Royaume-Uni. Les observations qui y sont recueillies balaient une préiode allant de 1973 à 2015.

Le jeu de données est accessible depuis le lien suivant :
http://api.gbif.org/v1/occurrence/download/request/0001358-190415153152247.zip

En raison du poids de ce dernier (2.5 Go pour près de 6 millions de lignes, de quoi mettre à genoux nos pauvres machines pour générer la carte...), seule une fraction (les 100 000 premières lignes) en a été utilisée.


GBIF.org (18th April 2019) GBIF Occurrence Download https://doi.org/10.15468/dl.nzyl42


## Répartition des occurences

La carte interactive ci-dessous présente les 

```{r map, echo=FALSE,warning=FALSE}
Latitude = c(dataset$decimalLatitude)
Longitude =c(dataset$decimalLongitude)
year = dataset$year
species = dataset$species
ladate= dataset$eventDate

```

```{r}
m<-leaflet(dataset) %>%
  addTiles() %>%
  
  addCircles(lng=~Longitude,lat =~Latitude,
                  color="#a500a5", opacity = 0.01) 

m
```


```{r graph1,warning=FALSE}
ggplot(dataset,aes(x=year)) +
 geom_line(stat="count",color="#69b3a2",linetype = "solid") +
ggtitle("Occurences par an") +
  xlab("Année") +
  ylab("Nombre d'occurrences") +
theme_ipsum()

```


```{r graph2,warning=FALSE}
ggplot(dataset %>% group_by(species) %>% filter(n() > 3500), aes(x=species)) +
geom_histogram(stat="count",fill="skyblue1") +
ggtitle("Occurences par espèce (au moins 3500 occurences)")+
  theme_ipsum()
```